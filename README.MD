# Mini Blog API

This project is a mini blog API generated by `express-generator`, designed only to practice chaining multiple middleware functions.  
Check [the local Version](https://github.com/namdosikh/layered-middleware-challenge/tree/dev-local), which is the initial version of this project.

## âœ¨ Features

- Logs requests and measures response time
- Role-based authentication via `x-user-role` header
- Request body validation
- Attaches timestamps to requests
- Global error handling

## ðŸ›  Middleware Functions

| Middleware           | Purpose                                              |
| -------------------- | ---------------------------------------------------- |
| `logger`             | Logs request method and URL                          |
| `timing`             | Logs response duration                               |
| `auth(role)`         | Validates `x-user-role` header for the required role |
| `validateBody(keys)` | Ensures request body contains required keys          |
| `attachTimestamp`    | Adds `req.timestamp = new Date()`                    |
| `errorHandler`       | Catches and returns all errors as JSON               |

## ðŸ“œ Routes & Middleware Mapping

| Route               | Middleware Chain                                                                |
| ------------------- | ------------------------------------------------------------------------------- |
| `GET /posts`        | `logger â†’ timing`                                                               |
| `POST /posts`       | `logger â†’ auth('editor') â†’ validateBody(['title','content']) â†’ attachTimestamp` |
| `PUT /posts/:id`    | `logger â†’ auth('editor') â†’ validateBody(['title']) â†’ attachTimestamp`           |
| `DELETE /posts/:id` | `logger â†’ auth('admin') â†’ attachTimestamp`                                      |
| **All routes**      | `errorHandler` (last)                                                           |

## ðŸš€ How to Run the Project

### Download the project to your local dekstop

Make sure you're already in the `main` branch!

```bash
git clone https://github.com/namdosikh/layered-middleware-challenge.git
```

### Install the dependencies

```bash
npm i
```

### Start the backend

```bash
npm start
```

### Test the API

1.  Run these in your browser :
    - `http://localhost:3000` to get the heart-welcoming template page of Express
    - `http://localhost:3000/users` to get all of the users data
    - `http://localhost:3000/tweets` to get all of the tweets data
2.  Use [this Postman](https://muhammadrasikh.postman.co/workspace/Muhammad-Rasikh's-Workspace~0df80228-87f5-4e1a-87df-63d5af64454e/collection/46298544-2e974c0f-3faf-467b-9678-531de247364b?action=share&creator=46298544) to test these methods :
    - Add a tweet
    - Edit a tweet's title or text
    - Delete a tweet
